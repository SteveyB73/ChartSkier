<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skier on Google Line Chart</title>

    <!-- Load Google Charts -->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

    <style>
      /* Container for the chart */
      #chart_div {
        position: relative;
        width: 800px;
        height: 500px;
        margin: 50px auto;
      }

      /* Skier sprite */
      #skier {
        position: absolute;
        width: 40px;
        height: 40px;
        background-image: url('https://i.imgur.com/2DQFfE9.png'); /* Replace with your own sprite if needed */
        background-size: contain;
        background-repeat: no-repeat;
        transform-origin: center;
        transition: transform 0.2s linear;
      }
    </style>
  </head>

  <body>
    <h2 style="text-align: center;">Skier Animation on a Google Line Chart</h2>

    <!-- Chart container -->
    <div id="chart_div">
      <div id="skier"></div>
    </div>

    <script>
      // Load Google Charts library
      google.charts.load('current', { packages: ['corechart'] });
      google.charts.setOnLoadCallback(drawChart);

      let chart, chartLayout;

      // Function to draw the line chart
      function drawChart() {
        const data = google.visualization.arrayToDataTable([
          ['X', 'Y'],
          [0, 0],
          [1, 2],
          [2, 3],
          [3, 2.5],
          [4, 4],
          [5, 5],
          [6, 3]
        ]);

        const options = {
          title: 'Skier on a Line Chart',
          curveType: 'function',
          legend: { position: 'bottom' }
        };

        chart = new google.visualization.LineChart(document.getElementById('chart_div'));

        // When the chart is ready, start the animation
        google.visualization.events.addListener(chart, 'ready', () => {
          chartLayout = chart.getChartLayoutInterface();
          animateSkier(data);
        });

        chart.draw(data, options);
      }

      // Function to animate the skier along the chart line
      function animateSkier(data) {
        const skier = document.getElementById('skier');
        const numPoints = data.getNumberOfRows();
        let currentPoint = 0;

        // Move the skier between points
        function moveSkier() {
          if (currentPoint >= numPoints - 1) return;

          // Get pixel positions of two points
          const x1 = chartLayout.getXLocation(data.getValue(currentPoint, 0));
          const y1 = chartLayout.getYLocation(data.getValue(currentPoint, 1));
          const x2 = chartLayout.getXLocation(data.getValue(currentPoint + 1, 0));
          const y2 = chartLayout.getYLocation(data.getValue(currentPoint + 1, 1));

          const deltaX = x2 - x1;
          const deltaY = y2 - y1;

          // Calculate angle and distance
          const angle = Math.atan2(deltaY, deltaX) * (180 / Math.PI);

          let step = 0;
          const steps = 100; // Controls the smoothness of the animation

          // Move skier step by step
          function stepMove() {
            if (step > steps) {
              currentPoint++;
              moveSkier(); // Move to the next segment
              return;
            }

            const progress = step / steps;
            const x = x1 + progress * deltaX;
            const y = y1 + progress * deltaY;

            // Apply translation and rotation
            skier.style.transform = `translate(${x}px, ${y}px) rotate(${angle}deg)`;

            step++;
            requestAnimationFrame(stepMove);
          }

          stepMove();
        }

        moveSkier();
      }
    </script>
  </body>
</html>
